import static org.junit.jupiter.api.Assertions.*;

import java.time.LocalDate;

import org.junit.jupiter.api.BeforeEach;
import org.junit.jupiter.api.Test;


public class CarRentalSystemTest {

    private CarDao carDao;
    private CustomerDao customerDao;
    private LeaseDao leaseDao;

    @BeforeEach
    public void setup() {
        carDao = new CarDaoImpl();
        customerDao = new CustomerDaoImpl();
        leaseDao = new LeaseDaoImpl();
    }

    @Test
    public void testCarCreatedSuccessfully() throws Exception {
        Car car = new Car("Toyota", "Sedan", "Yes");
        int carId = carDao.addCar(car);
        assertTrue(carId > 0);

        Car retrievedCar = carDao.getCarById(carId);
        assertEquals("Toyota", retrievedCar.getModel());
    }

    @Test
    public void testLeaseCreatedSuccessfully() throws Exception {
        Lease lease = new Lease(1, 1, "Monthly", LocalDate.now(), LocalDate.now().plusMonths(1), 5000.0);
        int leaseId = leaseDao.createLease(lease);
        assertTrue(leaseId > 0);
    }

    @Test
    public void testLeaseRetrievedSuccessfully() throws Exception {
        Lease lease = leaseDao.getLeaseById(1); // Ensure lease with ID 1 exists in test DB
        assertNotNull(lease);
        assertEquals(1, lease.getLeaseId());
    }

    @Test
    public void testInvalidCustomerThrowsException() {
        assertThrows(CustomerNotFoundException.class, () -> {
            customerDao.getCustomerById(-1);
        });
    }

    @Test
    public void testInvalidCarThrowsException() {
        assertThrows(CarNotFoundException.class, () -> {
            carDao.getCarById(-1);
        });
    }

    @Test
    public void testInvalidLeaseThrowsException() {
        assertThrows(LeaseNotFoundException.class, () -> {
            leaseDao.getLeaseById(-1);
        });
    }
}
