package com.java.Carrental.dao;

import java.sql.Connection;
import java.sql.PreparedStatement;
import java.sql.ResultSet;
import java.sql.SQLException;
import java.util.ArrayList;
import java.util.List;

import com.java.Carrental.model.Car;
import com.java.Carrental.util.ConnectionHelper;

public class CarImp implements Cardao {

	Connection con;
	PreparedStatement psmt;
	@Override
	public void addCar(Car car) throws ClassNotFoundException, SQLException {
		// TODO Auto-generated method stub
		  String cmd = "insert into CAR (id,brand, model, isAvailable) VALUES (?,?, ?, ?)";
		  con=ConnectionHelper.getConnection();
		  psmt=con.prepareStatement(cmd);
		  psmt.setInt(1, car.getId());
          psmt.setString(2, car.getBrand());
          psmt.setString(3, car.getModel();
          psmt.setBoolean(4,car.isAvailability());
          psmt.executeUpdate();
	}

	@Override
	public void remove(int carId) throws ClassNotFoundException, SQLException {
		// TODO Auto-generated method stub
		 String cmd = "DELETE FROM cars WHERE id = ?";
		 con=ConnectionHelper.getConnection();
		 psmt=con.prepareStatement(cmd);
		 psmt.setInt(1, carId);
         psmt.executeUpdate();
	}

	@Override
	public List<Car> showAvailableCars() throws ClassNotFoundException, SQLException {
		  List<Car> cars = new ArrayList<>();
	      String cmd = "SELECT * FROM cars WHERE available = true";
	      con=ConnectionHelper.getConnection();
	      psmt=con.prepareStatement(cmd);
	      ResultSet rs = psmt.executeQuery();
          while (rs.next()) {
        	  Car car = new Car();
              car.setId(rs.getInt("id"));
              car.setBrand(rs.getString("brand"));
              car.setModel(rs.getString("model"));
              car.setAvailability(rs.getBoolean("available"));//availabale=isAvailabale try
              cars.add(car);
          }
          return cars;
	}

	@Override
	public List<Car> showRentedCars() {
		// TODO Auto-generated method stub
		return null;
	}

	@Override
	public Car findCarById(int carId) {
		// TODO Auto-generated method stub
		return null;
	}

}
